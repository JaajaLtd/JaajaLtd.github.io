{"ast":null,"code":"import _slicedToArray from\"/Users/admin/Documents/react-projects/hesmis/hesmis-front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{isEmpty}from'lodash';import React,{useEffect,useState}from'react';import{Card}from'react-bootstrap';import{useDispatch,useSelector}from'react-redux';import{AlertMessage,DataNotFound,DataSpinner,ReloadButton}from'../../components/common';import{resultActions}from'../../config/actions';import usePrevious from'../Hooks/usePrevious';import MyResult from'./MyResult';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Result=function Result(){var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.result;}),results=_useSelector.results,loading=_useSelector.loading,loadError=_useSelector.loadError;var _useSelector2=useSelector(function(state){return state.auth;}),currentStudentProgramme=_useSelector2.currentStudentProgramme;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),myResult=_useState2[0],setMyResult=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];var prevState=usePrevious({loadError:loadError});var getMyResult=function getMyResult(){setErrorMessage(null);dispatch(resultActions.getMyResult(currentStudentProgramme===null||currentStudentProgramme===void 0?void 0:currentStudentProgramme.id));};useEffect(function(){if(results){var findResult=results.find(function(result){return result.programme_code===currentStudentProgramme.programme_code;});if(findResult)setMyResult(findResult);else getMyResult();}},[]);useEffect(function(){if(!isEmpty(results)){var findResult=results.find(function(result){return(result===null||result===void 0?void 0:result.programme_code)===(currentStudentProgramme===null||currentStudentProgramme===void 0?void 0:currentStudentProgramme.programme_code);});if(findResult)setMyResult(findResult);else{setMyResult({});setErrorMessage(null);}}},[results,loading]);useEffect(function(){if(!isEmpty(prevState)&&!isEmpty(loadError)&&loadError!==prevState.loadError){var _loadError$error,_loadError$server;setErrorMessage((loadError===null||loadError===void 0?void 0:(_loadError$error=loadError.error)===null||_loadError$error===void 0?void 0:_loadError$error.message)||(loadError===null||loadError===void 0?void 0:(_loadError$server=loadError.server)===null||_loadError$server===void 0?void 0:_loadError$server.message));}},[loadError]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"py-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font600 text-uppercase text-sm\",children:\"My Result\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card-options\",children:/*#__PURE__*/_jsx(ReloadButton,{loading:loading,onClick:getMyResult})})]}),/*#__PURE__*/_jsxs(Card.Body,{children:[errorMessage&&/*#__PURE__*/_jsx(AlertMessage,{message:errorMessage}),loading&&isEmpty(myResult)?/*#__PURE__*/_jsx(DataSpinner,{}):/*#__PURE__*/_jsx(_Fragment,{children:isEmpty(myResult)?/*#__PURE__*/_jsx(DataNotFound,{message:\"You have No Results\"}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(MyResult,{result:myResult})})})]})]})});};export default Result;","map":{"version":3,"sources":["/Users/admin/Documents/react-projects/hesmis/hesmis-front/src/containers/Results/index.jsx"],"names":["isEmpty","React","useEffect","useState","Card","useDispatch","useSelector","AlertMessage","DataNotFound","DataSpinner","ReloadButton","resultActions","usePrevious","MyResult","Result","dispatch","state","result","results","loading","loadError","auth","currentStudentProgramme","myResult","setMyResult","errorMessage","setErrorMessage","prevState","getMyResult","id","findResult","find","programme_code","error","message","server"],"mappings":"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","sourcesContent":["import { isEmpty } from 'lodash';\nimport React, { useEffect, useState } from 'react';\nimport { Card } from 'react-bootstrap';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  AlertMessage,\n  DataNotFound,\n  DataSpinner,\n  ReloadButton,\n} from '../../components/common';\nimport { resultActions } from '../../config/actions';\nimport usePrevious from '../Hooks/usePrevious';\nimport MyResult from './MyResult';\n\nconst Result = () => {\n  const dispatch = useDispatch();\n  const { results, loading, loadError } = useSelector((state) => state.result);\n  const { currentStudentProgramme } = useSelector((state) => state.auth);\n  const [myResult, setMyResult] = useState({});\n  const [errorMessage, setErrorMessage] = useState(null);\n  const prevState = usePrevious({ loadError });\n\n  const getMyResult = () => {\n    setErrorMessage(null);\n    dispatch(resultActions.getMyResult(currentStudentProgramme?.id));\n  };\n\n  useEffect(() => {\n    if (results) {\n      const findResult = results.find(\n        (result) =>\n          result.programme_code === currentStudentProgramme.programme_code\n      );\n      if (findResult) setMyResult(findResult);\n      else getMyResult();\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!isEmpty(results)) {\n      const findResult = results.find(\n        (result) =>\n          result?.programme_code === currentStudentProgramme?.programme_code\n      );\n      if (findResult) setMyResult(findResult);\n      else {\n        setMyResult({});\n        setErrorMessage(null);\n      }\n    }\n  }, [results, loading]);\n\n  useEffect(() => {\n    if (\n      !isEmpty(prevState) &&\n      !isEmpty(loadError) &&\n      loadError !== prevState.loadError\n    ) {\n      setErrorMessage(loadError?.error?.message || loadError?.server?.message);\n    }\n  }, [loadError]);\n\n  return (\n    <div>\n      <Card>\n        <Card.Header className=\"py-2\">\n          <div className=\"font600 text-uppercase text-sm\">My Result</div>\n          <div className=\"card-options\">\n            <ReloadButton loading={loading} onClick={getMyResult} />\n          </div>\n        </Card.Header>\n        <Card.Body>\n          {errorMessage && <AlertMessage message={errorMessage} />}\n          {loading && isEmpty(myResult) ? (\n            <DataSpinner />\n          ) : (\n            <>\n              {isEmpty(myResult) ? (\n                <DataNotFound message=\"You have No Results\" />\n              ) : (\n                <>\n                  <MyResult result={myResult} />\n                </>\n              )}\n            </>\n          )}\n        </Card.Body>\n      </Card>\n    </div>\n  );\n};\n\nexport default Result;\n"]},"metadata":{},"sourceType":"module"}